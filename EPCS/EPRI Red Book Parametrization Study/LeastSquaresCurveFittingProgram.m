clear all
global As
load Base Base
As=Base;
x0=zeros(1,25);
x0=[0.00127387716756549,0.00165619285997361,0.0501984848515261,-0.000666394404053768,3.27921469183686e-06,0.0267835198865763,-0.00240106761891375,-0.000154216621538726,2.50027968617140e-08,1.48996169830103e-09,-0.000117009056697966,-1.42476859893615e-06,1.03734050242485e-07,4.53242185074383e-09,5.84121171540187e-11,-3.92608112656691e-08,7.10829960549131e-08,-5.95016215426245e-10,-1.56324995533515e-11,2.68569725170256e-13,2.97245501222870e-10,-1.01254540577334e-10,-1.84545110304144e-12,1.64514834646120e-13,-3.05583879847322e-15]
x0=[-1.71149621145269,0.490799068230792,0.0218434491980167,-0.000364492331303949,1.07363893000548e-06,0.0224518619761490,-0.00244450025630907,-0.000150229233577477,3.22061468504681e-06,-5.79298589601012e-10,-0.000154025941103151,-4.17140918253837e-07,6.43482743392851e-08,-7.41094277894265e-10,-1.32683541058916e-10,3.95929047628967e-07,3.74198167521024e-08,1.32426785647594e-10,-4.46306920908083e-12,2.88256453610159e-13,-2.58185594968066e-10,-8.00442535471314e-11,1.08427958984056e-12,-2.51995700981102e-14,1.07994136916595e-16]
x0=[-1.71149621145269,0.490799068230792,0.0218434491980167,-0.000364492331303949,1.07363893000548e-06,0.0224518619761490,-0.00244450025630907,-0.000150229233577477,3.22061468504681e-06,-5.79298589601012e-10,-0.000154025941103151,-4.17140918253837e-07,6.43482743392851e-08,-7.41094277894265e-10,-1.32683541058916e-10,3.95929047628967e-07,3.74198167521024e-08,1.32426785647594e-10,-4.46306920908083e-12,2.88256453610159e-13,-2.58185594968066e-10,-8.00442535471314e-11,1.08427958984056e-12,-2.51995700981102e-14,1.07994136916595e-16]
x0=[-1.45030012019566,0.428067890854809,0.0150884723865904,0.000291950000328748,-1.22233147267906e-06,0.00243374062044858,-0.00135984191881789,-0.000162355976372466,-2.56909445892791e-06,4.66245528215599e-10,-3.27220724452856e-08,1.52357864545020e-08,4.02652906127660e-07,1.35189722703924e-08,3.00000892718842e-11,2.78483675988418e-08,2.89551269657220e-09,-1.14415792424063e-10,-2.88590075510244e-11,-1.89546892365479e-13,3.05853911499560e-13,-1.14480691252984e-11,2.96549313861846e-13,2.08151002854526e-15,4.52562844419792e-16]
x0=[-1.45528955910841,0.411583484978611,0.00673244224134971,0.000630132906844289,-2.45619313096732e-06,0.00870868239382704,-0.00241868914604116,-1.23209021466055e-05,-6.74931419244360e-06,-5.34050067942074e-10,-1.95808098353684e-07,2.22224602140542e-08,2.09134783296954e-08,2.38759828650788e-08,1.51812186941811e-10,-2.33827753742979e-08,1.33985470878761e-08,1.12230674272334e-10,-3.90086156848372e-11,-5.61151418636535e-13,-3.20059498983315e-11,-9.92470931458885e-12,-5.51604208848438e-13,3.09303022430254e-14,5.45999984808206e-16]
x0=[-1.28175558864981,0.486944667197670,0.0162796195535683,0.000532963745035843,-4.58743527407805e-06,-0.00257244763122654,-0.00217378944306810,-0.000225848465843316,-2.77631650965398e-06,9.85519110811828e-11,6.04840431163072e-05,8.39093620561482e-09,1.06015895012050e-06,1.44126295697381e-09,1.99574887878166e-10,-1.23489709617257e-07,1.92354277520006e-09,-1.52571279467304e-09,1.31698204400833e-12,-6.53329005755942e-13,1.34459015048611e-11,1.15617361851027e-11,2.76311950873532e-14,1.20022942353116e-14,5.48956923599540e-16]
x0=[-1.13615366783882,0.386536822859161,0.0204284173766757,0.000433074018244550,-3.38570488638837e-06,0.00190855168535316,-0.00186594524895810,-0.000219071330569411,-3.10846122687952e-06,-3.64513418500652e-11,2.59294707158351e-05,-9.69834519257203e-08,9.38249478537298e-07,6.13988974115746e-09,1.64834420727788e-10,-6.09620966523212e-08,6.43517787742177e-09,-1.50179193194743e-09,-5.41130437702587e-12,-5.83272713956387e-13,-1.09552568580519e-12,-3.25043414930232e-13,4.85882150016661e-13,7.93810986933548e-15,5.51410878327862e-16]
x0=[2.57231675736281,0.566763470620598,-0.0211415847464837,0.00132754997012515,-6.90564669516609e-06,-0.0282302258911667,-0.00277623219147546,9.32454124366149e-05,-9.84225329363900e-06,3.24813321488654e-08,7.98515313315166e-05,2.36707283117884e-06,1.10851811524053e-07,2.56278640133477e-08,-1.50449952480972e-11,-2.63260328319338e-08,1.21452089513314e-09,-5.56347734612423e-10,-3.71980763694403e-11,-8.53561721539972e-16,-8.44254839789147e-11,1.30368006073539e-12,2.56519748323408e-13,2.98751430521554e-14,-9.32699670171218e-17]
x0=[2.53465889877699,-0.0421984346409335,0.0329135788486635,-0.000121131228230497,2.22308658013595e-06,-0.0293594552236457,0.00144959563800640,-0.000269667791049930,6.10458538029075e-07,-2.74577733014864e-08,0.000113860544485835,-6.62543354113905e-06,6.94451527373884e-07,4.71612658577582e-09,7.34932025513316e-11,-1.67732974490062e-07,8.04308954701348e-09,-3.87888740412993e-10,-2.75358302159655e-11,3.09796613446275e-15,7.20436077724228e-11,-1.98023641080176e-13,-3.90645666907296e-13,3.39622709903678e-14,-1.21708482531817e-16]
x0=[2.80909216300600,0.191541267236160,0.0197937271787954,-6.79887179821098e-07,5.80666682735882e-07,-0.0289747440900898,-0.000865355083709777,-0.000159035447515910,-8.67118855549825e-08,-7.15385358740062e-09,0.000124670661468869,-3.06300552260099e-06,6.94389418324282e-07,-2.92518098160765e-09,4.91604309985369e-11,-1.84913358522983e-07,6.79703456120779e-09,-9.11084211173999e-10,-1.02505906506708e-12,-1.23204977852173e-14,6.40510007566537e-11,1.30949301916804e-12,8.56998633768115e-14,1.24259017267877e-14,-1.06995894873053e-16]
x0=[2.86132215864575,0.0940309051555633,0.0338392132818588,6.33621112475851e-07,-4.77823458377046e-06,-0.0300456681899995,-0.000587441861446656,-0.000270817519462979,-3.16825622659198e-07,4.52468621592318e-08,0.000125003549153690,-1.53597680526391e-07,9.10338663273354e-07,5.29126772202983e-10,-1.49040145787628e-10,-2.27479698855147e-07,4.23036329320093e-09,-1.41621984417427e-09,6.02343790812110e-13,2.14420660358133e-13,1.49746039793975e-10,-4.63315463061784e-12,8.21803054081679e-13,-8.10308299680270e-16,-1.18426037546083e-16]
x0=[2.83722063369395,0.120015970492283,0.0336925587413547,-5.69555056020303e-06,-4.84302283904610e-06,-0.0309818985710153,-0.000725633280848452,-0.000270095625333877,-4.21368399896559e-07,4.86884467783004e-08,0.000126682876854041,4.80794328476922e-07,8.99160536738524e-07,1.38057634757084e-09,-1.67844049556811e-10,-2.24575249826300e-07,3.08018484864899e-09,-1.41965422425315e-09,-2.88721405292986e-14,2.37685813831418e-13,1.44491007128855e-10,-4.09703727715999e-12,8.64529562235261e-13,-1.87387527165836e-15,-1.17479352359148e-16]
x0=[2.76535120168782,0.106433913248196,0.0336764786011796,3.67061176362950e-06,-4.87654718694623e-06,-0.0301445034962532,-0.000593020176645579,-0.000271286700913909,-4.62192296448163e-07,4.85234067367623e-08,0.000124351934807619,-4.12070073097699e-08,9.08307647871324e-07,1.38315681916561e-09,-1.66261298487578e-10,-2.23368311169653e-07,3.99104030456489e-09,-1.43747673290984e-09,1.43369618451030e-14,2.35790223210480e-13,1.45700882999004e-10,-4.67934767461175e-12,8.74991214438357e-13,-1.85610704801436e-15,-1.17486574333425e-16]
x0=[2.75864337646668,0.0344733802420491,0.0391386176339167,-0.000135079724660226,-3.68208033382066e-06,-0.0274796655915574,-0.000304579335465087,-0.000299406839002771,2.66967337875967e-07,4.21744725622123e-08,0.000107791385380334,3.90616246573419e-08,9.39431473513265e-07,5.25767619004378e-10,-1.58395413837482e-10,-1.92402195548960e-07,3.11390001845305e-09,-1.43447516555475e-09,-3.48301700454578e-14,2.35461996758345e-13,1.28502799776365e-10,-4.33898849263444e-12,8.78003392865210e-13,-1.84211459547052e-15,-1.17445365958245e-16]
x0=[2.75920441950744,0.0408449302445427,0.0387687599054210,-0.000123962449357726,-3.80591473772760e-06,-0.0271644009119494,-0.000378556517931010,-0.000296974182370828,2.10059898427073e-07,4.28556594932559e-08,0.000105363503768229,3.55960249825564e-07,9.34284348359103e-07,5.68068902212560e-10,-1.59238003264415e-10,-1.85830368468068e-07,2.43495029564606e-09,-1.42606754215499e-09,7.42219720375152e-15,2.35517732542581e-13,1.22736768250301e-10,-3.78657556131978e-12,8.69626872183993e-13,-1.84743886029577e-15,-1.17440107426252e-16]
x0=[2.75631319982440,0.0302003465929522,0.0373644165928017,-6.27719807178712e-05,-4.32681214350192e-06,-0.0288456470543954,3.77239740185839e-05,-0.000298910663470697,-1.96881803810503e-08,4.44643006505737e-08,0.000113827677706462,-1.72885978630840e-06,9.70446110528340e-07,6.59282576364944e-10,-1.57139635512471e-10,-1.97076248914955e-07,5.72795808571968e-09,-1.48200297687518e-09,-1.11887506138640e-14,2.28126269674276e-13,1.25165425315408e-10,-5.23746450026062e-12,8.77186920351755e-13,-1.36550392174854e-15,-1.15257921235044e-16]
%% Least squares curve fitting
tol1=1e-5;
tol2=1e-5;
tol3=1e-5;
LB=[];
UB=[];
A=[];
B=[];
Aeq=[];
Beq=[];
options=optimset('Algorithm','active-set','Display','iter','TolFun',tol1,'TolCon',tol2,'TolX',tol3,'MaxIter',300,'MaxFunEvals',10000);
%FMINCON Call objetive function and non-linear constraints 
[x,fval,exitflag,output,lambda,grad,hessian]=fmincon('minq4',x0,A,B,Aeq,Beq,LB,UB,'restr',options);
% Test the accuracy of regression
%  i=50;
%  j=542;
%   H=(x(1)+x(2)*i+x(3)*i^2+x(4)*i^3+x(5)*i^4)+(x(6)+x(7)*i+x(8)*i^2+x(9)*i^3+x(10)*i^4)*j+...
%                 (x(11)+x(12)*i+x(13)*i^2+x(14)*i^3+x(15)*i^4)*j^2+(x(16)+x(17)*i+x(18)*i^2+x(19)*i^3+x(20)*i^4)*j^3+...
%                 (x(21)+x(22)*i+x(23)*i^2+x(24)*i^3+x(25)*i^4)*j^4
% Base(i,j)

